# Solidityï¼šrequire()ã€assert()ã€revert()åŒºåˆ«åˆ°åº•åœ¨å“ªï¼Ÿ

## ğŸ’Example

å¦‚ä¸‹ä¸‰è¡Œæ˜¯ä¸`if(msg.sender != owner) { throw; }`çš„æ•ˆæœæ˜¯ç­‰ä»·çš„ã€‚

```solidity
if(msg.sender != owner) { revert(); } 

assert(msg.sender == owner);
 
require(msg.sender == owner);
```

ä¸‹é¢å…·ä½“è¯´è¯´è¿™ä¸‰ä¸ªå‡½æ•°çš„åŒºåˆ«ã€‚

## ğŸ’Require()ä½¿ç”¨åœºæ™¯

1. éªŒè¯ç”¨æˆ·è¾“å…¥ï¼Œå³ï¼š `require(input<20);`
2. éªŒè¯å¤–éƒ¨åˆçº¦å“åº”ï¼Œå³ï¼š `require(external.send(amount));`
3. æ‰§è¡Œåˆçº¦å‰ï¼ŒéªŒè¯çŠ¶æ€æ¡ä»¶ï¼Œå³ï¼š `require(block.number > SOME_BLOCK_NUMBER)` æˆ–è€… `require(balance[msg.sender]>=amount)`
4. requireåº”è¯¥è¢«**æœ€å¸¸ä½¿ç”¨**åˆ°ï¼›ä¸€èˆ¬ç”¨äºå‡½æ•°çš„**å¼€å¤´å¤„**ã€‚

## ğŸ’Assert()ä½¿ç”¨åœºæ™¯

1. æ£€æŸ¥ overflow/underflowï¼Œ

   ä¾‹ï¼š`c = a+b; assert(c > b);`

2. æ£€æŸ¥éå˜é‡ï¼ˆinvariantsï¼‰ï¼Œ

   ä¾‹ï¼š`assert(this.balance >= totalSupply);`

3. éªŒè¯æ”¹å˜åçš„çŠ¶æ€ï¼Œä¸åº”è¯¥å‘ç”Ÿçš„æ¡ä»¶

4. ä¸€èˆ¬åœ°ï¼Œ**å°½é‡å°‘ä½¿ç”¨** assert è°ƒç”¨ï¼Œå¦‚è¦ä½¿ç”¨assert åº”è¯¥åœ¨**å‡½æ•°ç»“å°¾å¤„**ä½¿ç”¨

5. åŸºæœ¬ä¸Šï¼Œ`require()` åº”è¯¥è¢«ç”¨äºå‡½æ•°ä¸­æ£€æŸ¥æ¡ä»¶ï¼Œ`assert()` ç”¨äºé¢„é˜²ä¸åº”è¯¥å‘ç”Ÿçš„æƒ…å†µï¼Œä½†ä¸åº”è¯¥ä½¿æ¡ä»¶é”™è¯¯ã€‚

6. å¦å¤–ï¼Œâ€œé™¤éè®¤ä¸ºä¹‹å‰çš„æ£€æŸ¥ï¼ˆç”¨ if æˆ– require ï¼‰ä¼šå¯¼è‡´æ— æ³•éªŒè¯ overflowï¼Œå¦åˆ™ä¸åº”è¯¥ç›²ç›®ä½¿ç”¨ assert æ¥æ£€æŸ¥ overflowâ€

## â­Requireå¯¹æ¯”Assertï¼Œä¸ºä»€ä¹ˆAssertç”¨çš„å°‘ï¼Ÿ

### Gasæ¶ˆè€—

åŒæ ·ä½œä¸ºåˆ¤æ–­ä¸€ä¸ªæ¡ä»¶æ˜¯å¦æ»¡è¶³çš„å‡½æ•°ï¼Œrequireä¼šé€€å›å‰©ä¸‹çš„gasï¼Œè€Œassertä¼šçƒ§æ‰æ‰€æœ‰çš„gasã€‚

### æŠ¥é”™åˆ†æ

require()è¯­å¥çš„å¤±è´¥æŠ¥é”™åº”è¯¥è¢«çœ‹ä½œä¸€ä¸ªæ­£å¸¸çš„åˆ¤æ–­è¯­å¥æµç¨‹ä¸é€šè¿‡çš„äº‹ä»¶ï¼›

è€Œassert()è¯­å¥çš„å¤±è´¥æŠ¥é”™ï¼Œæ„å‘³ç€å‘ç”Ÿäº†ä»£ç å±‚é¢çš„é”™è¯¯äº‹ä»¶ï¼Œå¾ˆå¤§å¯èƒ½æ˜¯åˆçº¦ä¸­æœ‰ä¸€ä¸ªbugéœ€è¦ä¿®å¤ã€‚



## ğŸ’Revert()ç‰¹ç‚¹

1. å…è®¸ä½ è¿”å›ä¸€ä¸ªå€¼ï¼›

   ä¾‹ï¼š`revert(â€˜Something bad happenedâ€™);`ç­‰ä»·äº`require(condition, â€˜Something bad happenedâ€™);`

2. å®ƒä¼šæŠŠæ‰€æœ‰å‰©ä¸‹çš„gasé€€å›ç»™caller

   

## â­Requireå¯¹æ¯”Revertï¼Œå¤æ‚æ—¶å€™ç”¨Revert

## Gasæ¶ˆè€—

ä¸¤è€…ä¸€æ ·éƒ½ä¼šå‘å‰©ä½™çš„gasè´¹è¿”è¿˜ç»™è°ƒç”¨è€…

## ä½¿ç”¨å·®å¼‚

revert()å¤„ç†ä¸ require() åŒæ ·çš„ç±»å‹ï¼Œä½†æ˜¯éœ€è¦æ›´å¤æ‚å¤„ç†é€»è¾‘çš„åœºæ™¯

å¦‚æœæœ‰å¤æ‚çš„ if/else é€»è¾‘æµï¼Œé‚£ä¹ˆåº”è¯¥è€ƒè™‘ä½¿ç”¨ revert() å‡½æ•°è€Œä¸æ˜¯require()ã€‚è®°ä½ï¼Œå¤æ‚é€»è¾‘æ„å‘³ç€æ›´å¤šçš„ä»£ç ã€‚
